<html>
    <head>
        <script src="https://cdn.jsdelivr.net/npm/phaser@3.24.1/dist/phaser.js"></script>
    </head>
    <body>
        <script>
            //VARIABLES
            var config={
                type: Phaser.AUTO,
                width: 800,
                height: 600,
                physics: {
                    default: 'arcade',
                    arcade: {
                        gravity: {y : 0}
                    }
                },
                scene: {
                    preload: preload, //carga los recursos que necesitamos para nuestro juego
                    create: create,
                    update: update
                }
            }

            var game= new Phaser.Game(config);

            var fondo;
            var player;
            var contador;
            var combo;
            //FUNCIONES 

            function preload (){
                //this.load.image('Yacuza','../resources/img/characters/Yacuza/Yacuza_Pose_1.png');
                this.load.spritesheet('Yacuza',
                    '../resources/img/characters/Yacuza/Yacuza_Animacion_2_SpriteSheet.png',
                    {frameWidth: 256, frameHeight: 256}
                );
            }
            function create ()
            {
                //this.add.image(400,300,'Yacuza'); // X e Y de la imagen.
                player = this.physics.add.sprite(256, 256, 'Yacuza');
                
                this.anims.create({
                    key: 'animacion',
                    frames: this.anims.generateFrameNumbers('Yacuza', {start: 0, end: 5}),
                    frameRate: 5,
                    repeat: -1
                });
            }

            function update ()
            {
                player.anims.play('animacion', true);

                //GameLoop en proceso
                if(contador == 4)
                {
                    contador = 0;
                    combo = GenerarCombo();
                }
                this.add.sprite(200, 200, combo[contador].sprite);
                if(this.input.keyboard.isDown(combo[contador].key))
                {
                    contador++;
                    //etc
                }
            }

            function Tecla(key, damage, animation, sonido, sprite) //Generador de Teclas
            {
                this.key = key;
                this.damage = damage;
                this.animation = animation;
                this.sonido = sonido;
                this.sprite = sprite;
            }

            var W = new Tecla(Phaser.keyboard.W, 1, 'animacion'); //Inicializar cada tecla que se vaya a usar
            var A = new Tecla(Phaser.keyboard.A, 1, 'animacion');
            var S = new Tecla(Phaser.keyboard.S, 1, 'animacion');
            var D = new Tecla(Phaser.keyboard.D, 1, 'animacion');

            var teclasJugador1 = [W,A,S,D]; //Array de teclas que usa el jugador 1

            function GenerarCombo() //Crea un array donde guarda el combo generado aleatoriamente con las teclas creadas
            {
                for (let i = 0; i < 4; i++) {
                    var random = Phaser.Math.RandomDataGenerator.integerInRange(0, 3);
                    combo[i] = teclasJugador1[random];
                }
            }

        </script>
    </body>
</html>
